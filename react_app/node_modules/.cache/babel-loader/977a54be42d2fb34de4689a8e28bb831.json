{"ast":null,"code":"var _jsxFileName = \"/Users/bbe/Dev/Module/visual_stock_v2/react_app/src/widget.js\";\nimport React from 'react';\nimport PriceTrending from './market_data.js';\nimport Tabs from 'react-bootstrap/Tabs';\nimport MyContext from './my_context.js';\nconst base_widget = {\n  display: 'flex',\n  flexDirection: 'column',\n  width: '100%',\n  height: '100%',\n  backgroundColor: 'yellow'\n};\nconst title = {\n  backgroundColor: 'orange',\n  padding: '1vh',\n  fontFamily: 'Arial, Helvetica, sans-serif'\n};\nconst nav_bar = {\n  backgroundColor: 'blue',\n  padding: '1vh'\n};\nconst ul_as_bar = {\n  listStyleType: 'none',\n  display: 'flex',\n  flexDirection: 'row',\n  justifyContent: 'space-between',\n  paddingInlineStart: '0'\n};\nconst url = 'wss://stream.binance.com/stream?streams=!miniTicker@arr';\nlet isConnected = false;\nlet socket = null;\n\nclass MarketWidget extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data_list: null,\n      // all stream data\n      tab_index: [] //\tall keys\n\n    };\n  }\n\n  setup_websocket() {\n    return new Promise((resolve, reject) => {\n      let channel = new WebSocket(url);\n\n      channel.onopen = () => {\n        isConnected = true;\n        resolve(channel);\n      };\n\n      channel.onmessage = e => {\n        console.log(e.data);\n        this.setState({\n          data_list: e.data\n        });\n      };\n\n      channel.onerror = e => {\n        reject(e);\n      };\n    });\n  }\n\n  close_websocket(channel) {\n    return new Promise((resolve, reject) => {\n      channel.close();\n\n      channel.onclose = () => {\n        isConnected = false;\n        resolve(null);\n      };\n\n      channel.onerror = e => {\n        reject(e);\n      };\n    });\n  }\n\n  socket_setup() {\n    socket = this.setup_websocket().then(channel => {\n      socket = channel;\n      window.alert('open channel !');\n    }).catch(error => {\n      window.alert('failed to setup !');\n    });\n  }\n\n  websocket_clickhandler() {\n    if (!isConnected) {\n      this.setup_websocket().then(channel => {\n        socket = channel;\n        window.alert('open channel !');\n      }).catch(error => {\n        window.alert('failed to setup !');\n      });\n    } else {\n      this.close_websocket(socket).then(channel => {\n        socket = channel;\n        window.alert('close channel !');\n      }).catch(error => {\n        window.alert('failed to close !');\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: base_widget,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => this.websocket_clickhandler(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 12\n      }\n    }, \" Market \"))), /*#__PURE__*/React.createElement(MyContext.Consumer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: nav_bar,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      style: ul_as_bar,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 7\n      }\n    }, api_data => /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 16\n      }\n    }, Object.keys(api_data.structure).map((item, i) => /*#__PURE__*/React.createElement(\"li\", {\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 21\n      }\n    }, item))))), api_data => /*#__PURE__*/React.createElement(PriceTrending, {\n      data_list: api_data[this.state.cur_index],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 20\n      }\n    })));\n  }\n\n}\n\nexport default MarketWidget;","map":{"version":3,"sources":["/Users/bbe/Dev/Module/visual_stock_v2/react_app/src/widget.js"],"names":["React","PriceTrending","Tabs","MyContext","base_widget","display","flexDirection","width","height","backgroundColor","title","padding","fontFamily","nav_bar","ul_as_bar","listStyleType","justifyContent","paddingInlineStart","url","isConnected","socket","MarketWidget","Component","constructor","props","state","data_list","tab_index","setup_websocket","Promise","resolve","reject","channel","WebSocket","onopen","onmessage","e","console","log","data","setState","onerror","close_websocket","close","onclose","socket_setup","then","window","alert","catch","error","websocket_clickhandler","render","api_data","Object","keys","structure","map","item","i","cur_index"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PriceTrending from './market_data.js'\nimport Tabs from 'react-bootstrap/Tabs'\nimport MyContext from './my_context.js'\n\n\n\n\nconst base_widget = {\n\tdisplay: 'flex',\n\tflexDirection: 'column',\n\twidth: '100%',\n\theight: '100%',\n\tbackgroundColor: 'yellow',\n}\n\nconst title = {\n\tbackgroundColor: 'orange',\n\tpadding: '1vh',\n\tfontFamily: 'Arial, Helvetica, sans-serif',\n}\n\nconst nav_bar = {\n\tbackgroundColor: 'blue',\n\tpadding: '1vh',\n}\n\nconst ul_as_bar = {\n\tlistStyleType: 'none',\n\tdisplay: 'flex',\n\tflexDirection: 'row',\n\tjustifyContent: 'space-between',\n\tpaddingInlineStart: '0',\n}\n\n\nconst url = 'wss://stream.binance.com/stream?streams=!miniTicker@arr'\nlet isConnected = false\nlet socket = null\n\n\nclass MarketWidget extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tdata_list: null, // all stream data\n\t\t\ttab_index: []\t//\tall keys\n\t\t}\n\t}\n\n\tsetup_websocket() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet channel = new WebSocket(url)\n\t\t\tchannel.onopen = () => {\n\t\t\t\tisConnected = true\n\t\t\t\tresolve(channel)\n\t\t\t}\n\t\t\tchannel.onmessage = (e) => {\n\t\t\t\tconsole.log(e.data)\n\t\t\t\tthis.setState({\n\t\t\t\t\tdata_list: e.data\n\t\t\t\t})\n\t\t\t}\n\t\t\tchannel.onerror = (e) => {\n\t\t\t\treject(e)\n\t\t\t}\n\t\t})\n\t}\n\n\tclose_websocket(channel) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tchannel.close()\n\t\t\tchannel.onclose = () => {\n\t\t\t\tisConnected = false\n\t\t\t\tresolve(null)\n\t\t\t}\n\t\t\tchannel.onerror = (e) => {\n\t\t\t\treject(e)\n\t\t\t}\n\t\t})\n\t}\n\n\tsocket_setup() {\n\t\tsocket = this.setup_websocket().then(channel => {\n\t\t\tsocket = channel\n\t\t\twindow.alert('open channel !')\n\t\t}).catch(error => {\n\t\t\twindow.alert('failed to setup !')\n\t\t})\n\t}\n\n\twebsocket_clickhandler() {\n\t\tif (!isConnected) {\t\t\n\t\t\tthis.setup_websocket().then(channel => {\n\t\t\t\tsocket = channel\n\t\t\t\twindow.alert('open channel !')\n\t\t\t}).catch(error => {\n\t\t\t\twindow.alert('failed to setup !')\n\t\t\t})\n\t\t}\n\t\telse {\n\t\t\tthis.close_websocket(socket).then(channel => {\n\t\t\t\tsocket = channel\n\t\t\t\twindow.alert('close channel !')\n\t\t\t}).catch(error => {\n\t\t\t\twindow.alert('failed to close !')\n\t\t\t})\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div style = { base_widget }>\n\t\t\t\t<button onClick={() => this.websocket_clickhandler()}/>\n\t\t\t\t<div style = { title }>\n\t\t\t\t\t<span><h3> Market </h3></span>\n\t\t\t\t</div>\n\t\t\t\t<MyContext.Consumer>\n\t\t\t\t\t<div style = { nav_bar }>\n\t\t\t\t\t\t<ul style = { ul_as_bar }>\n\t\t                \t{\n\t\t                \t\tapi_data => (\n\t\t\t\t\t\t\t        <React.Fragment>\n\t\t\t\t\t\t\t            {\n\n\t\t\t\t\t\t\t            \tObject.keys(api_data.structure).map((item, i) => (\n\t\t\t\t\t\t            \t\t<li key={i}>\n\t\t\t\t\t\t            \t\t\t{ item }\n\t\t\t\t\t\t            \t\t</li>\n\t\t\t\t\t\t\t        \t))}\n\t\t\t\t\t\t\t        </React.Fragment>\n\t\t\t\t\t\t        )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n                \t{\n                \t\tapi_data => (\n                \t\t\t<PriceTrending data_list={ api_data[this.state.cur_index] }/>\n\t\t\t\t        )\n\t\t\t\t\t}\n\t\t\t\t</MyContext.Consumer>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default MarketWidget;"]},"metadata":{},"sourceType":"module"}